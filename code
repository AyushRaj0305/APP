from kivy.lang import Builder
from kivymd.app import MDApp
from kivy.uix.label import Label
from kivy.uix.popup import Popup
from kivy.uix.screenmanager import Screen,ScreenManager


kv = '''
#:import get_color_from_hex kivy.utils.get_color_from_hex
ScreenManager:
    LogRegWindow:
    First:
    Second:
    LoginWindow:
    RegisterWindow:

<First>:
    name:'first'

    MDToolbar:
        title: "CATALYST"
        id:toolbar
        elevation: 10
        specific_text_color: get_color_from_hex('#FCF6F5FF')
        pos_hint: {'top':1.0}
        md_bg_color:  get_color_from_hex('#422057FF')
        right_action_items: [["logout", lambda x: app.check_login()],["information", lambda x: app.info()]]
    MDBoxLayout:

        size_hint: 1, 0.9
        orientation : 'vertical'
        MDScreen:
            MDBottomNavigation:
                panel_color: get_color_from_hex('#422057FF')
                text_color_active: 0,0,0,1
                pos_hint: {'x':0, 'y':0}
                text_color_normal :get_color_from_hex('#FCF6F5FF')

                MDBottomNavigationItem:
                    name: 'screen 1'
                    text: 'Study'
                    icon: 'creation'
                    badge_icon: "numeric-10"
                    md_bg_color:get_color_from_hex('#2BAE66FF')

                    ScrollView:
                        MDBoxLayout:
                            md_bg_color:get_color_from_hex('#ED2B33FF')
                            orientation:'vertical'
                            adaptive_height: True
                            padding:[dp(15),dp(15),dp(15),dp(35)]
                            spacing:dp(15)
                            height :self.minimum_height
                            ElementCard:

                                text:"Digital Library"
                                subtext:""
                                items_count:"Gov Of India"
                                on_release : root.manager.current = 'second'
                            ElementCard:

                                text: "Top Colleges"
                                subtext:""
                                items_count:"Worldwide"
                                on_release : root.manager.current = 'second'

                            ElementCard:

                                text:"Settings"
                                subtext:"...."
                                items_count:"...."
                                on_release : root.manager.current = 'second'
                            ElementCard:
                                
                                text:"Settings"
                                subtext:"...."
                                items_count:"..."
                                on_release : root.manager.current = 'second'
                MDBottomNavigationItem:
                    name: 'screen 2'
                    text: 'Chat'
                    icon: 'chat'
                    badge_icon: "numeric-5"

                    MDLabel:
                        text: 'Chat'
                        #md_bg_color:get_color_from_hex('#ED2B33FF')
                        halign: 'center'

                MDBottomNavigationItem:
                    name: 'screen 3'
                    text: 'Blog'
                    icon: 'blogger'

                    MDLabel:
                        text: 'Blog'
                        halign: 'center'


                MDBottomNavigationItem:
                    name: 'screen 4'
                    text: 'PROFILE'
                    icon: 'human-greeting'

                    MDLabel:
                        text: 'Profile'
                        halign: 'center'


<ElementCard@MDCard>:
    #md_bg_color:69/255,55/255,86/255,1
    padding:dp(15)
    spacing:dp(15)
    radius:dp(25)
    ripple_behavior: True
    image:''
    text:""
    items_count:""
    subtext:''

    orientation:'vertical'
    size_hint_y: None
    height: box.height + self.padding[1] + self.padding[3]

    MDBoxLayout:
        id: box
        adaptive_height: True
        Image:
            source:root.image
        MDBoxLayout:
            orientation:'vertical'
            adaptive_height: True
            orientation:'vertical'
            MDLabel:
                halign:"center"
                text:root.text
                font_style:"H6"
            MDLabel:
                halign:"center"
                font_style:"Caption"
                text:root.subtext
            MDLabel:
                halign:"center"
                text:root.items_count


<Second>:
    name: 'second'
    MDToolbar:
        title: "CATALYST"
        elevation: 10
        pos_hint: {'top':1.0}
        md_bg_color: get_color_from_hex('#422057FF')
        right_action_items: [["home", lambda x: app.home()]]
        left_action_items: [["keyboard-backspace", lambda x: app.home()]]
    MDBoxLayout:
        size_hint: 1, 0.9

        orientation : 'vertical'

        MDLabel:
            text: 'Work in Progress!!'
            pos_hint: {'top':1}
            #halign: 'center'
<LoginWindow>:
    name : 'login'
    MDFloatLayout:
        canvas:
            Color:
                rgb:get_color_from_hex('#FEE715FF')
            Ellipse:
                angle_start:0
                angle_end:360
                pos:50,-200
                size:400,430
        md_bg_color : get_color_from_hex('#422057FF')
        MDFillRoundFlatIconButton:
            pos_hint:{"x":0.05,"y":0.9}

            icon:'keyboard-backspace'
            icon_color:get_color_from_hex('#FCF6F5FF')
            md_bg_color: get_color_from_hex('#422057FF')
            on_press: root.manager.current = 'logreg'

        MDTextField:
            hint_text: 'Email'
            line_color_normal: get_color_from_hex('#FEE715FF')
            id: email
            multiline: False
            pos_hint: {"x": 0.09 , "top":0.9}
            size_hint: 0.8, 0.12
            font_size: '20sp'
            icon_right: "gmail"


        MDTextField:

            hint_text: 'Password'
            id: password

            line_color_normal: get_color_from_hex('#FEE715FF')

            multiline: False
            password: True
            pos_hint: {"x": 0.09, "top":0.7}
            size_hint: 0.8, 0.12
            icon_right: 'security'
            font_size: '20sp'

        MDFillRoundFlatIconButton:
            pos_hint:{"x":0.06,"y":0.4}
            size_hint: 0.9, 0.1
            icon:'lock'
            text: "[b]Login[/b]"
            on_press: app.login()
            md_bg_color: get_color_from_hex('#FEE715FF')
            font_size: '20sp'

        MDFillRoundFlatIconButton:
            pos_hint:{"x":0.06,"y":0.2}
            size_hint: 0.9, 0.1
            text_color : get_color_from_hex('#FCF6F5FF')
            icon_color: get_color_from_hex('#FCF6F5FF')
            font_size: '25sp'
            text: "[b]Register[/b]"
            icon:'login'
            md_bg_color: get_color_from_hex('#000000')
            on_press: root.manager.current = 'register'


<RegisterWindow>:
    name : 'register'

    MDFloatLayout:
        canvas:
            Color:
                rgb:get_color_from_hex('#FEE715FF')
            Ellipse:
                angle_start:0
                angle_end:360
                pos:-120,400
                size:400,430

        md_bg_color : get_color_from_hex('#422057FF')
        MDFillRoundFlatIconButton:
            pos_hint:{"x":0.05,"y":0.9}

            icon:'keyboard-backspace'
            icon_color:get_color_from_hex('#000000')

            md_bg_color: get_color_from_hex('#FEE715FF')
            on_press: root.manager.current = 'logreg'
        MDTextField:
            mode: "rectangle"
            hint_text: 'Email'
            text_color:get_color_from_hex('#000000')
            id: email
            font_size: (root.width**2 + root.height**2) / 13**4
            multiline: False
            pos_hint: {"x": 0.09 , "top":0.9}
            size_hint: 0.8, 0.12
            font_size: '25sp'
            icon_right: "gmail"


        MDTextField:
            mode: 'rectangle'
            hint_text: 'Password'
            id: password
            font_size: (root.width**2 + root.height**2) / 13**4
            multiline: False
            password: True
            pos_hint: {"x": 0.09, "top":0.7}
            size_hint: 0.8, 0.12
            icon_right: 'security'
            font_size: '25sp'

        MDFillRoundFlatIconButton:
            pos_hint:{"x":0.05,"y":0.23}
            size_hint: 0.9, 0.1
            icon:'login'

            text: "[b]Register[/b]"
            md_bg_color: get_color_from_hex('#FEE715FF')
            font_size: '25sp'
            on_press : app.register()

        MDFillRoundFlatIconButton:
            pos_hint:{"x":0.05,"y":0.1}
            size_hint: 0.9, 0.1
            icon:'lock'
            text_color : get_color_from_hex('#FCF6F5FF')
            icon_color: get_color_from_hex('#FCF6F5FF')
            font_size: '25sp'
            text: "[b]Have An Account ?[/b]"

            md_bg_color: get_color_from_hex('#000000')
            on_press: root.manager.current = 'login'

        MDTextField:
            mode: "rectangle"
            hint_text: 'Name'
            id: name
            color:get_color_from_hex('#422057FF')

            multiline: False
            pos_hint: {"x": 0.09 , "y":0.4}
            size_hint: 0.8, 0.12
            font_size: '25sp'
            icon_right: "account"

<LogRegWindow>:
    name : 'logreg'

    MDFloatLayout:
        canvas:
            Color:
                rgb:get_color_from_hex('#FEE715FF')
            Ellipse:
                angle_start:0
                angle_end:360
                pos:-210,240
                size:600,530
        md_bg_color : get_color_from_hex('#422057FF')

        MDLabel:
            text:'LOGO And Name Of APP Here'
            pos_hint:{"x":0.1,"y":0.6}
            size_hint: 0.5, 0.1
            md_bg_color: get_color_from_hex('#FEE715FF')
            font_size: '30sp'
            text_color : get_color_from_hex('#FCF6F5FF')
        MDFillRoundFlatIconButton:
            pos_hint:{"x":0.05,"y":0.23}
            size_hint: 0.5, 0.1
            icon:'lock'

            text: "[b]Login[/b]"
            md_bg_color: get_color_from_hex('#000000')
            text_color : get_color_from_hex('#FCF6F5FF')
            icon_color: get_color_from_hex('#FCF6F5FF')
            font_size: '25sp'
            on_press : root.manager.current = 'login'

        MDFillRoundFlatIconButton:
            pos_hint:{"x":0.05,"y":0.1}
            size_hint: 0.9, 0.1
            icon:'login'
            text_color : get_color_from_hex('#FCF6F5FF')
            icon_color: get_color_from_hex('#FCF6F5FF')
            font_size: '25sp'
            text: "[b]Register[/b]"

            md_bg_color: get_color_from_hex('#000000')
            on_press: root.manager.current = 'register'


'''

class LogRegWindow(Screen):
    pass
class First(Screen):
    pass
class Second(Screen):
    pass
class LoginWindow(Screen):
    pass
class RegisterWindow(Screen):
    pass



class Test(MDApp):

    def build(self):
        self.title = 'Catalyst'
        self.theme_cls.primary_palette = "Yellow"


        self.root = Builder.load_string(kv)
        self.check_login()

    def check_login(self):
        # checks if user has logged in or not if yes then direct mainscreen else login screen.......
        '''
        word = open('storage.txt')
        text = word.read()
        print(text)
        if text == 'False':
            self.root.get_screen('login').manager.current = 'login'
        else:
            pass
        '''
        self.root.get_screen('logreg').manager.current = 'logreg'

    def login(self):
        # login for user.......
        # validation.......sql commands.........select........
        self.root.get_screen('first').manager.current = 'first'

    def callback(self):
        # nothing just for testing time.......
        print('work in progress!!')

    def home(self):
        # gets main screen............
        print('home')
        self.root.get_screen('first').manager.current = 'first'

    def info(self):
        # Information about app and credits.......
        print('info')
        popup = Popup(title='Information',
                      content= Label(text='App Information And Credits'),
                      size_hint=(None, None), size=(500, 500)).open()

    def register(self):
        # sql commands and stuff..........
        # sql commands ......insert.......
        #..........
        self.root.get_screen('login').manager.current = 'login'


Test().run()




